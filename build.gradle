apply plugin: "java"
apply plugin: "eclipse"

defaultTasks = ["clean", "build", "jar"]

repositories {
    flatDir { dirs "lib" }
}

dependencies {
    if (System.getProperty("os.name").toLowerCase().contains("linux")) {
        System.out.println(System.getProperty("os.arch"))
        if (System.getProperty("os.arch").equals("x86")
            || System.getProperty("os.arch").equals("i386")) {
            compile ":swt-4.2.2-gtk-linux-x86"
        } else { // assume it's 64-bit
            compile ":swt-4.2.2-gtk-linux-x86_64"
        }
    } else if (System.getProperty("os.name").toLowerCase().contains("win")) {
        if (System.getProperty("os.arch").equals("x86")
            || System.getProperty("os.arch").equals("i386")) {
         compile ":swt-4.2.2-win32-win32-x86"
        } else { // assume it's 64-bit
            compile ":swt-4.2.2-win32-win32-x86_64"
        }
    } else {
        throw new RuntimeException("Your OS is not supported!")
    }
}   

jar {
    dependsOn configurations.runtime
    from { configurations.runtime.collect { it.isDirectory() ? it : zipTree(it) } }
    manifest {
        attributes "Main-Class": "org.fredy.jcalendar.JCalendar"
    }
}
